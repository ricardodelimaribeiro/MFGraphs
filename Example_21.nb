(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    118739,       2789]
NotebookOptionsPosition[    116394,       2741]
NotebookOutlinePosition[    116785,       2757]
CellTagsIndexPosition[    116742,       2754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Start choosing the example:", "Subsection",
 CellChangeTimes->{{3.807950436465856*^9, 
  3.8079504513874207`*^9}},ExpressionUUID->"9d02279c-549c-4a7b-a0a3-\
3086c4faa000"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", "21"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", "[", "x", "]"}]}], "Input",
 CellChangeTimes->{{3.807950419074286*^9, 3.8079504216972313`*^9}, {
   3.80803066636535*^9, 3.808030694230341*^9}, {3.808030924486598*^9, 
   3.808030936770438*^9}, {3.808031210106669*^9, 3.80803121305068*^9}, {
   3.808031659477334*^9, 3.808031660630096*^9}, {3.808031815550593*^9, 
   3.808031825024506*^9}, 3.808032940898757*^9, {3.808047025377515*^9, 
   3.808047026052237*^9}, {3.8104386588599377`*^9, 3.810438658988085*^9}, {
   3.810537139126058*^9, 3.810537139180338*^9}, {3.81053844305475*^9, 
   3.8105384665759573`*^9}, {3.810539248355556*^9, 3.810539248389201*^9}, {
   3.812633427650338*^9, 3.812633427912162*^9}, 3.812633745009308*^9, 
   3.812637334481298*^9, {3.812786713590403*^9, 3.812786714898406*^9}, {
   3.812962447435433*^9, 3.8129624522732553`*^9}, {3.812962536380787*^9, 
   3.812962538002017*^9}, {3.812962573587336*^9, 3.8129625877819223`*^9}, {
   3.813978890946733*^9, 3.813978947888439*^9}, {3.814001080615563*^9, 
   3.8140011358961678`*^9}, {3.8143432232451887`*^9, 3.814343227698132*^9}, {
   3.8143432691716843`*^9, 3.814343279523725*^9}, {3.8145406500160627`*^9, 
   3.814540661732573*^9}, {3.81636435663721*^9, 3.8163643590914183`*^9}, {
   3.8188673315486526`*^9, 3.818867331746501*^9}, {3.818915201823699*^9, 
   3.818915202906588*^9}, {3.818922671045163*^9, 
   3.8189226744086313`*^9}},ExpressionUUID->"4307edc5-c37f-40b8-b85e-\
e4011dc2650a"],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{
  3.81504516378415*^9, 3.8161572341117773`*^9, 3.8163643652547617`*^9, 
   3.816364705136641*^9, 3.816365091987626*^9, 3.8165800964701853`*^9, 
   3.816835752631624*^9, 3.818867332910263*^9, {3.818915206712287*^9, 
   3.818915207997078*^9}, 3.8189221726577682`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"2f041c83-545c-4989-a724-dce20da2a5b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\</Users/ribeirrd/eclipse-workspace/MFGraphs/MFGraphs/Examples/\
ExamplesData.m\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8150451322076693`*^9, 
  3.8150451597443438`*^9}},ExpressionUUID->"b93b4544-93d2-4ec7-b534-\
400f9879408d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DataToEquations and the critical congestion solver", "Subsection",
 CellChangeTimes->{{3.806651309650549*^9, 3.806651321154381*^9}, {
  3.80776392133749*^9, 3.807763922663989*^9}, {3.807950300614449*^9, 
  3.8079503256480303`*^9}},ExpressionUUID->"40572573-c3d2-4935-b25a-\
0520de835ab2"],

Cell[BoxData[
 RowBox[{"Data", "=", 
  RowBox[{"DataG", "[", "t", "]"}]}]], "Input",
 CellChangeTimes->{{3.806651342407763*^9, 3.8066513640438538`*^9}, {
   3.806744669784532*^9, 3.806744670659512*^9}, {3.8074402538858337`*^9, 
   3.807440254668627*^9}, {3.807511566301404*^9, 3.807511568209476*^9}, 
   3.8075263727715807`*^9, 3.80777796341055*^9, {3.807837774852503*^9, 
   3.807837775564624*^9}, {3.8078435561492*^9, 3.80784355625004*^9}, {
   3.807843898877075*^9, 3.807843899274146*^9}, {3.8078443145524693`*^9, 
   3.807844314707603*^9}, {3.8078622893677053`*^9, 3.807862290166773*^9}, {
   3.8079501448736343`*^9, 3.807950146152231*^9}, {3.8079502696621027`*^9, 
   3.807950293701563*^9}, {3.807950416053688*^9, 3.807950416384759*^9}, {
   3.8080470131610737`*^9, 3.808047015067747*^9}, {3.810539341699339*^9, 
   3.8105393435155497`*^9}, 3.812184637731494*^9, 3.812687328129014*^9, {
   3.8127868459471617`*^9, 3.812786849166623*^9}, {3.814343290747538*^9, 
   3.814343291114017*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"20f26292-94b2-455c-9005-babb32d5d746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\</Users/ribeirrd/eclipse-workspace/MFGraphs/MFGraphs/NonLinearSolver.m\
\>\"", "]"}], ";", 
  RowBox[{"Data", "=", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<Vertices List\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8", ",", "9", ",", "10", ",", "11", ",", "12"}], "}"}]}], ",", 
     RowBox[{"\"\<Adjacency Matrix\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"\"\<Entrance Vertices and Currents\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "I1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "I2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Exit Vertices and Terminal Costs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "U1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "U2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "U3"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Switching Costs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"12", ",", "9", ",", "7", ",", "1000000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "9", ",", "11", ",", "1000000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "7", ",", "5", ",", "1000000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "7", ",", "9", ",", "1000000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "8", ",", "6", ",", "1000000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "8", ",", "7", ",", "1000000"}], "}"}]}], 
       "}"}]}]}], "\[RightAssociation]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d2e", " ", "=", " ", 
   RowBox[{"Data2Equations", "[", 
    RowBox[{"Data", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"I1", "\[Rule]", "1"}], ",", 
       RowBox[{"I2", "\[Rule]", "2"}], ",", 
       RowBox[{"U1", "\[Rule]", "1"}], ",", 
       RowBox[{"U2", "\[Rule]", "2"}], ",", " ", 
       RowBox[{"U3", "\[Rule]", "3"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8593887759365807`*^9, 3.859388779846072*^9}, 
   3.859388842422597*^9, 3.859389019572249*^9, {3.859430814959903*^9, 
   3.859430824724264*^9}, {3.859875002981612*^9, 3.85987508605331*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"2cd9451a-fe74-4087-8136-59cd2929bc8a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CriticalCongestionSolver", "[", 
   RowBox[{"d2e", "=", " ", 
    RowBox[{"Data2Equations", "[", 
     RowBox[{"Data", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"I1", "\[Rule]", "1"}], ",", 
        RowBox[{"I2", "\[Rule]", "2"}], ",", 
        RowBox[{"U1", "\[Rule]", "1"}], ",", 
        RowBox[{"U2", "\[Rule]", "2"}], ",", " ", 
        RowBox[{"U3", "\[Rule]", "3"}]}], "}"}]}], "]"}]}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CriticalCongestionSolver", "[", "d2e", "]"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8598712787020197`*^9, 3.859871281688057*^9}, {
  3.859884045138426*^9, 3.859884065365965*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2ae874b2-72a4-43b5-9f6d-0f1242a9f6fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.127566`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"j36", "\[Rule]", "1"}], ",", 
     RowBox[{"j38", "\[Rule]", "2"}], ",", 
     RowBox[{"j35", "\[Rule]", "0"}], ",", 
     RowBox[{"j37", "\[Rule]", "0"}], ",", 
     RowBox[{"j29", "\[Rule]", "0"}], ",", 
     RowBox[{"j31", "\[Rule]", "0"}], ",", 
     RowBox[{"j33", "\[Rule]", "0"}], ",", 
     RowBox[{"j2", "\[Rule]", "1"}], ",", 
     RowBox[{"j4", "\[Rule]", "2"}], ",", 
     RowBox[{"j1", "\[Rule]", "0"}], ",", 
     RowBox[{"j6", "\[Rule]", "0"}], ",", 
     RowBox[{"j8", "\[Rule]", 
      FractionBox["18", "13"]}], ",", 
     RowBox[{"j3", "\[Rule]", "0"}], ",", 
     RowBox[{"j5", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"j10", "\[Rule]", 
      FractionBox["21", "13"]}], ",", 
     RowBox[{"j7", "\[Rule]", "0"}], ",", 
     RowBox[{"j12", "\[Rule]", "0"}], ",", 
     RowBox[{"j14", "\[Rule]", 
      FractionBox["20", "13"]}], ",", 
     RowBox[{"j9", "\[Rule]", "0"}], ",", 
     RowBox[{"j11", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"j16", "\[Rule]", 
      FractionBox["19", "13"]}], ",", 
     RowBox[{"j13", "\[Rule]", "0"}], ",", 
     RowBox[{"j18", "\[Rule]", "0"}], ",", 
     RowBox[{"j20", "\[Rule]", "0"}], ",", 
     RowBox[{"j22", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"j15", "\[Rule]", "0"}], ",", 
     RowBox[{"j17", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"j24", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"j26", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"j19", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"j23", "\[Rule]", "0"}], ",", 
     RowBox[{"j28", "\[Rule]", "0"}], ",", 
     RowBox[{"j21", "\[Rule]", "0"}], ",", 
     RowBox[{"j30", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"j25", "\[Rule]", "0"}], ",", 
     RowBox[{"j32", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"j27", "\[Rule]", "0"}], ",", 
     RowBox[{"j34", "\[Rule]", "0"}], ",", 
     RowBox[{"u30", "\[Rule]", "1"}], ",", 
     RowBox[{"u32", "\[Rule]", "2"}], ",", 
     RowBox[{"u34", "\[Rule]", "3"}], ",", 
     RowBox[{"jt12", "\[Rule]", 
      FractionBox["21", "13"]}], ",", 
     RowBox[{"jt13", "\[Rule]", "0"}], ",", 
     RowBox[{"jt14", "\[Rule]", "0"}], ",", 
     RowBox[{"jt2", "\[Rule]", "1"}], ",", 
     RowBox[{"jt20", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"jt23", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"jt24", "\[Rule]", 
      FractionBox["19", "13"]}], ",", 
     RowBox[{"jt25", "\[Rule]", "0"}], ",", 
     RowBox[{"jt26", "\[Rule]", "0"}], ",", 
     RowBox[{"jt3", "\[Rule]", "0"}], ",", 
     RowBox[{"jt38", "\[Rule]", "0"}], ",", 
     RowBox[{"jt4", "\[Rule]", "2"}], ",", 
     RowBox[{"jt40", "\[Rule]", "0"}], ",", 
     RowBox[{"jt46", "\[Rule]", "0"}], ",", 
     RowBox[{"jt5", "\[Rule]", "0"}], ",", 
     RowBox[{"jt50", "\[Rule]", "0"}], ",", 
     RowBox[{"jt51", "\[Rule]", "0"}], ",", 
     RowBox[{"jt52", "\[Rule]", "0"}], ",", 
     RowBox[{"jt53", "\[Rule]", "0"}], ",", 
     RowBox[{"jt54", "\[Rule]", "0"}], ",", 
     RowBox[{"jt55", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt56", "\[Rule]", "0"}], ",", 
     RowBox[{"jt58", "\[Rule]", "0"}], ",", 
     RowBox[{"jt59", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"jt6", "\[Rule]", "1"}], ",", 
     RowBox[{"jt60", "\[Rule]", "0"}], ",", 
     RowBox[{"jt61", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"jt62", "\[Rule]", "0"}], ",", 
     RowBox[{"jt63", "\[Rule]", "0"}], ",", 
     RowBox[{"jt64", "\[Rule]", "0"}], ",", 
     RowBox[{"jt7", "\[Rule]", "0"}], ",", 
     RowBox[{"jt8", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"jt9", "\[Rule]", "0"}], ",", 
     RowBox[{"u29", "\[Rule]", "1"}], ",", 
     RowBox[{"u31", "\[Rule]", "2"}], ",", 
     RowBox[{"u33", "\[Rule]", "3"}], ",", 
     RowBox[{"u36", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u38", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"jt1", "\[Rule]", "0"}], ",", 
     RowBox[{"jt35", "\[Rule]", "0"}], ",", 
     RowBox[{"jt39", "\[Rule]", "0"}], ",", 
     RowBox[{"jt43", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"jt57", "\[Rule]", "0"}], ",", 
     RowBox[{"u10", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u13", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u14", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u15", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u16", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u18", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u19", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u2", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u20", "\[Rule]", "3"}], ",", 
     RowBox[{"u21", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u22", "\[Rule]", "1"}], ",", 
     RowBox[{"u25", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u26", "\[Rule]", "2"}], ",", 
     RowBox[{"u27", "\[Rule]", "3"}], ",", 
     RowBox[{"u28", "\[Rule]", "3"}], ",", 
     RowBox[{"u35", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u37", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"u4", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"u7", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u8", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u9", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"jt15", "\[Rule]", "0"}], ",", 
     RowBox[{"jt21", "\[Rule]", "0"}], ",", 
     RowBox[{"jt47", "\[Rule]", "0"}], ",", 
     RowBox[{"jt48", "\[Rule]", "0"}], ",", 
     RowBox[{"jt18", "\[Rule]", 
      FractionBox["18", "13"]}], ",", 
     RowBox[{"jt31", "\[Rule]", 
      FractionBox["20", "13"]}], ",", 
     RowBox[{"jt36", "\[Rule]", "0"}], ",", 
     RowBox[{"jt37", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt49", "\[Rule]", "0"}], ",", 
     RowBox[{"u1", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u11", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u12", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u17", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u23", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u24", "\[Rule]", "3"}], ",", 
     RowBox[{"u3", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"u5", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u6", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"jt45", "\[Rule]", "0"}], ",", 
     RowBox[{"jt10", "\[Rule]", "0"}], ",", 
     RowBox[{"jt11", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"jt16", "\[Rule]", "0"}], ",", 
     RowBox[{"jt17", "\[Rule]", "0"}], ",", 
     RowBox[{"jt19", "\[Rule]", "0"}], ",", 
     RowBox[{"jt22", "\[Rule]", "0"}], ",", 
     RowBox[{"jt27", "\[Rule]", "0"}], ",", 
     RowBox[{"jt28", "\[Rule]", "0"}], ",", 
     RowBox[{"jt29", "\[Rule]", "0"}], ",", 
     RowBox[{"jt30", "\[Rule]", "0"}], ",", 
     RowBox[{"jt32", "\[Rule]", "0"}], ",", 
     RowBox[{"jt33", "\[Rule]", "0"}], ",", 
     RowBox[{"jt34", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"jt41", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"jt42", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt44", "\[Rule]", "0"}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8598712867666492`*^9, 3.859874538035617*^9, 
  3.8598750898633337`*^9, 3.859884035560824*^9, 3.859884070440612*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"5c154bfb-2697-402c-bcf0-2571fca0cb0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.064014`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"j36", "\[Rule]", "1"}], ",", 
     RowBox[{"j38", "\[Rule]", "2"}], ",", 
     RowBox[{"j35", "\[Rule]", "0"}], ",", 
     RowBox[{"j37", "\[Rule]", "0"}], ",", 
     RowBox[{"j29", "\[Rule]", "0"}], ",", 
     RowBox[{"j31", "\[Rule]", "0"}], ",", 
     RowBox[{"j33", "\[Rule]", "0"}], ",", 
     RowBox[{"j2", "\[Rule]", "1"}], ",", 
     RowBox[{"j4", "\[Rule]", "2"}], ",", 
     RowBox[{"j1", "\[Rule]", "0"}], ",", 
     RowBox[{"j6", "\[Rule]", "0"}], ",", 
     RowBox[{"j8", "\[Rule]", 
      FractionBox["18", "13"]}], ",", 
     RowBox[{"j3", "\[Rule]", "0"}], ",", 
     RowBox[{"j5", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"j10", "\[Rule]", 
      FractionBox["21", "13"]}], ",", 
     RowBox[{"j7", "\[Rule]", "0"}], ",", 
     RowBox[{"j12", "\[Rule]", "0"}], ",", 
     RowBox[{"j14", "\[Rule]", 
      FractionBox["20", "13"]}], ",", 
     RowBox[{"j9", "\[Rule]", "0"}], ",", 
     RowBox[{"j11", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"j16", "\[Rule]", 
      FractionBox["19", "13"]}], ",", 
     RowBox[{"j13", "\[Rule]", "0"}], ",", 
     RowBox[{"j18", "\[Rule]", "0"}], ",", 
     RowBox[{"j20", "\[Rule]", "0"}], ",", 
     RowBox[{"j22", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"j15", "\[Rule]", "0"}], ",", 
     RowBox[{"j17", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"j24", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"j26", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"j19", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"j23", "\[Rule]", "0"}], ",", 
     RowBox[{"j28", "\[Rule]", "0"}], ",", 
     RowBox[{"j21", "\[Rule]", "0"}], ",", 
     RowBox[{"j30", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"j25", "\[Rule]", "0"}], ",", 
     RowBox[{"j32", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"j27", "\[Rule]", "0"}], ",", 
     RowBox[{"j34", "\[Rule]", "0"}], ",", 
     RowBox[{"u30", "\[Rule]", "1"}], ",", 
     RowBox[{"u32", "\[Rule]", "2"}], ",", 
     RowBox[{"u34", "\[Rule]", "3"}], ",", 
     RowBox[{"jt12", "\[Rule]", 
      FractionBox["21", "13"]}], ",", 
     RowBox[{"jt13", "\[Rule]", "0"}], ",", 
     RowBox[{"jt14", "\[Rule]", "0"}], ",", 
     RowBox[{"jt2", "\[Rule]", "1"}], ",", 
     RowBox[{"jt20", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"jt23", "\[Rule]", 
      FractionBox["2", "13"]}], ",", 
     RowBox[{"jt24", "\[Rule]", 
      FractionBox["19", "13"]}], ",", 
     RowBox[{"jt25", "\[Rule]", "0"}], ",", 
     RowBox[{"jt26", "\[Rule]", "0"}], ",", 
     RowBox[{"jt3", "\[Rule]", "0"}], ",", 
     RowBox[{"jt38", "\[Rule]", "0"}], ",", 
     RowBox[{"jt4", "\[Rule]", "2"}], ",", 
     RowBox[{"jt40", "\[Rule]", "0"}], ",", 
     RowBox[{"jt46", "\[Rule]", "0"}], ",", 
     RowBox[{"jt5", "\[Rule]", "0"}], ",", 
     RowBox[{"jt50", "\[Rule]", "0"}], ",", 
     RowBox[{"jt51", "\[Rule]", "0"}], ",", 
     RowBox[{"jt52", "\[Rule]", "0"}], ",", 
     RowBox[{"jt53", "\[Rule]", "0"}], ",", 
     RowBox[{"jt54", "\[Rule]", "0"}], ",", 
     RowBox[{"jt55", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt56", "\[Rule]", "0"}], ",", 
     RowBox[{"jt58", "\[Rule]", "0"}], ",", 
     RowBox[{"jt59", "\[Rule]", 
      FractionBox["49", "26"]}], ",", 
     RowBox[{"jt6", "\[Rule]", "1"}], ",", 
     RowBox[{"jt60", "\[Rule]", "0"}], ",", 
     RowBox[{"jt61", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"jt62", "\[Rule]", "0"}], ",", 
     RowBox[{"jt63", "\[Rule]", "0"}], ",", 
     RowBox[{"jt64", "\[Rule]", "0"}], ",", 
     RowBox[{"jt7", "\[Rule]", "0"}], ",", 
     RowBox[{"jt8", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"jt9", "\[Rule]", "0"}], ",", 
     RowBox[{"u29", "\[Rule]", "1"}], ",", 
     RowBox[{"u31", "\[Rule]", "2"}], ",", 
     RowBox[{"u33", "\[Rule]", "3"}], ",", 
     RowBox[{"u36", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u38", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"jt1", "\[Rule]", "0"}], ",", 
     RowBox[{"jt35", "\[Rule]", "0"}], ",", 
     RowBox[{"jt39", "\[Rule]", "0"}], ",", 
     RowBox[{"jt43", "\[Rule]", 
      FractionBox["29", "26"]}], ",", 
     RowBox[{"jt57", "\[Rule]", "0"}], ",", 
     RowBox[{"u10", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u13", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u14", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u15", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u16", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u18", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u19", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u2", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u20", "\[Rule]", "3"}], ",", 
     RowBox[{"u21", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u22", "\[Rule]", "1"}], ",", 
     RowBox[{"u25", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u26", "\[Rule]", "2"}], ",", 
     RowBox[{"u27", "\[Rule]", "3"}], ",", 
     RowBox[{"u28", "\[Rule]", "3"}], ",", 
     RowBox[{"u35", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u37", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"u4", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"u7", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u8", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u9", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"jt15", "\[Rule]", "0"}], ",", 
     RowBox[{"jt21", "\[Rule]", "0"}], ",", 
     RowBox[{"jt47", "\[Rule]", "0"}], ",", 
     RowBox[{"jt48", "\[Rule]", "0"}], ",", 
     RowBox[{"jt18", "\[Rule]", 
      FractionBox["18", "13"]}], ",", 
     RowBox[{"jt31", "\[Rule]", 
      FractionBox["20", "13"]}], ",", 
     RowBox[{"jt36", "\[Rule]", "0"}], ",", 
     RowBox[{"jt37", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt49", "\[Rule]", "0"}], ",", 
     RowBox[{"u1", "\[Rule]", 
      FractionBox["177", "26"]}], ",", 
     RowBox[{"u11", "\[Rule]", 
      FractionBox["115", "26"]}], ",", 
     RowBox[{"u12", "\[Rule]", 
      FractionBox["119", "26"]}], ",", 
     RowBox[{"u17", "\[Rule]", 
      FractionBox["75", "26"]}], ",", 
     RowBox[{"u23", "\[Rule]", 
      FractionBox["81", "26"]}], ",", 
     RowBox[{"u24", "\[Rule]", "3"}], ",", 
     RowBox[{"u3", "\[Rule]", 
      FractionBox["213", "26"]}], ",", 
     RowBox[{"u5", "\[Rule]", 
      FractionBox["151", "26"]}], ",", 
     RowBox[{"u6", "\[Rule]", 
      FractionBox["161", "26"]}], ",", 
     RowBox[{"jt45", "\[Rule]", "0"}], ",", 
     RowBox[{"jt10", "\[Rule]", "0"}], ",", 
     RowBox[{"jt11", "\[Rule]", 
      FractionBox["5", "13"]}], ",", 
     RowBox[{"jt16", "\[Rule]", "0"}], ",", 
     RowBox[{"jt17", "\[Rule]", "0"}], ",", 
     RowBox[{"jt19", "\[Rule]", "0"}], ",", 
     RowBox[{"jt22", "\[Rule]", "0"}], ",", 
     RowBox[{"jt27", "\[Rule]", "0"}], ",", 
     RowBox[{"jt28", "\[Rule]", "0"}], ",", 
     RowBox[{"jt29", "\[Rule]", "0"}], ",", 
     RowBox[{"jt30", "\[Rule]", "0"}], ",", 
     RowBox[{"jt32", "\[Rule]", "0"}], ",", 
     RowBox[{"jt33", "\[Rule]", "0"}], ",", 
     RowBox[{"jt34", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"jt41", "\[Rule]", 
      FractionBox["3", "13"]}], ",", 
     RowBox[{"jt42", "\[Rule]", 
      FractionBox["3", "26"]}], ",", 
     RowBox[{"jt44", "\[Rule]", "0"}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8598712867666492`*^9, 3.859874538035617*^9, 
  3.8598750898633337`*^9, 3.859884035560824*^9, 3.8598840715055103`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"094fd6dc-c61f-44da-a18d-7c75e0b1c197"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Last", "[", "%33", "]"}], "//", "Values"}]], "Input",
 CellChangeTimes->{{3.859884101778385*^9, 3.8598841058282547`*^9}},
 NumberMarks->False,
 CellLabel->"In[35]:=",ExpressionUUID->"8171d59b-513e-4b08-b013-b894b5b3f182"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "2", ",", "0", ",", "0", ",", 
   FractionBox["18", "13"], ",", "0", ",", 
   FractionBox["5", "13"], ",", 
   FractionBox["21", "13"], ",", "0", ",", "0", ",", 
   FractionBox["20", "13"], ",", "0", ",", 
   FractionBox["2", "13"], ",", 
   FractionBox["19", "13"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["49", "26"], ",", "0", ",", 
   FractionBox["3", "13"], ",", 
   FractionBox["3", "26"], ",", 
   FractionBox["29", "26"], ",", 
   FractionBox["3", "26"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["49", "26"], ",", "0", ",", 
   FractionBox["29", "26"], ",", "0", ",", "0", ",", "1", ",", "2", ",", "3", 
   ",", 
   FractionBox["21", "13"], ",", "0", ",", "0", ",", "1", ",", 
   FractionBox["2", "13"], ",", 
   FractionBox["2", "13"], ",", 
   FractionBox["19", "13"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", 
   FractionBox["3", "26"], ",", "0", ",", "0", ",", 
   FractionBox["49", "26"], ",", "1", ",", "0", ",", 
   FractionBox["29", "26"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["5", "13"], ",", "0", ",", "1", ",", "2", ",", "3", ",", 
   FractionBox["177", "26"], ",", 
   FractionBox["213", "26"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["29", "26"], ",", "0", ",", 
   FractionBox["119", "26"], ",", 
   FractionBox["115", "26"], ",", 
   FractionBox["75", "26"], ",", 
   FractionBox["119", "26"], ",", 
   FractionBox["81", "26"], ",", 
   FractionBox["81", "26"], ",", 
   FractionBox["75", "26"], ",", 
   FractionBox["151", "26"], ",", "3", ",", 
   FractionBox["75", "26"], ",", "1", ",", 
   FractionBox["81", "26"], ",", "2", ",", "3", ",", "3", ",", 
   FractionBox["177", "26"], ",", 
   FractionBox["213", "26"], ",", 
   FractionBox["161", "26"], ",", 
   FractionBox["151", "26"], ",", 
   FractionBox["115", "26"], ",", 
   FractionBox["161", "26"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["18", "13"], ",", 
   FractionBox["20", "13"], ",", "0", ",", 
   FractionBox["3", "26"], ",", "0", ",", 
   FractionBox["177", "26"], ",", 
   FractionBox["115", "26"], ",", 
   FractionBox["119", "26"], ",", 
   FractionBox["75", "26"], ",", 
   FractionBox["81", "26"], ",", "3", ",", 
   FractionBox["213", "26"], ",", 
   FractionBox["151", "26"], ",", 
   FractionBox["161", "26"], ",", "0", ",", "0", ",", 
   FractionBox["5", "13"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["3", "13"], ",", 
   FractionBox["3", "13"], ",", 
   FractionBox["3", "26"], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.859884106135377*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"f67c667a-8835-4ff5-9187-ebfb16413e77"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonLinear", "[", "d2e", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.859430895923685*^9, 3.859430899111287*^9}, 
   3.859432440182083*^9},ExpressionUUID->"8bae9680-ae42-449a-8f31-\
4a7714294442"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GetKirchhoffMatrix", "[", "d2e", "]"}]], "Input",
 CellChangeTimes->{{3.8594273919012213`*^9, 3.8594273961931343`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"e737f0c2-9031-47ae-9aad-557d766de56e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIhIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vb1V
+e64WUrn7OcYL9pi/uOK/YtFio8DV70aFR9gcQC3Ouc8
                "], {{0, 0}, {18,
                 1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "35", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIhIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vb1V
+e64WUrn7OcYL9pi/uOK/YtFio8DV70aFR9gcQC3Ouc8
                "], {{0, 0}, {18,
                 1}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "35", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.05714285714285714`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "2", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[Automatic, {35}, 0, {1, {{0, 2}, {{1}, {2}}}, {1, 2}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQAmJJIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlf1A
iSvraD0qmXTZvqhhlbSlzHp7+wl7ijWcHw+Ye0bFB6f4g8+HOR4GXrRf1Sx+
Y9/tE/ZTJPO19357NujcOSo+PMRH09vAivvefMleOvGC/d0tkssVV923v8v5
Lf75szdDJl6GuvuHujiu8MfV3sClfrCVMwPlzlFx/PE1VOJltFyirvjfb6UP
5ghesueffeIMq95T+0sFp+7UKL8f7e+MilMkTmo6ITUdDjbx0XIJv/icw1tv
Hb73wL7k43Zbx6SX9ueezM7N63mPM3xGy5lRcWLENytfLa8LPAdNJ/PtPbMW
phS9uoMzPw71cmZUfLR8HgzhNtjcSWp/h1rpZKj3p0bFBzYdjqaTgc3vg00c
V/tkqPtrVHxgy43BNm481MVxhRsucYX3odrCdUftGaBAZMvJh5P9Lg/58fPB
5p6hLk5qO3Nnt4Hrzi0v7G+4L19XM+2t/cmI3H/xXweuPzuaHoa3OKnxS+t2
y2h6GxWnZzt8sLlzVBy/OAD5z2SZ
                "], {{0, 0}, {25, 18}}, {0, 1}], 
               AspectRatio -> 1, Axes -> False, Frame -> False, 
               FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["191", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"35", ",", "97"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQAmJJIAaxrcp3x81SOmc/x3jRFvMfV+xfLFJ8HLjqlf1A
iSvraD0qmXTZvqhhlbSlzHp7+wl7ijWcHw+Ye0bFB6f4g8+HOR4GXrRf1Sx+
Y9/tE/ZTJPO19357NujcOSo+PMRH09vAivvefMleOvGC/d0tkssVV923v8v5
Lf75szdDJl6GuvuHujiu8MfV3sClfrCVMwPlzlFx/PE1VOJltFyirvjfb6UP
5ghesueffeIMq95T+0sFp+7UKL8f7e+MilMkTmo6ITUdDjbx0XIJv/icw1tv
Hb73wL7k43Zbx6SX9ueezM7N63mPM3xGy5lRcWLENytfLa8LPAdNJ/PtPbMW
phS9uoMzPw71cmZUfLR8HgzhNtjcSWp/h1rpZKj3p0bFBzYdjqaTgc3vg00c
V/tkqPtrVHxgy43BNm481MVxhRsucYX3odrCdUftGaBAZMvJh5P9Lg/58fPB
5p6hLk5qO3Nnt4Hrzi0v7G+4L19XM+2t/cmI3H/xXweuPzuaHoa3OKnxS+t2
y2h6GxWnZzt8sLlzVBy/OAD5z2SZ
                "], {{0, 0}, {25, 18}}, {0, 1}], 
               AspectRatio -> 1, Axes -> False, Frame -> False, 
               FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["191", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"35", ",", "97"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.05625920471281296`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "26"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "27"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "12"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "1"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {35, 97}, 0, {
     1, {{0, 1, 2, 6, 9, 13, 16, 22, 28, 34, 40, 46, 52, 58, 64, 70, 76, 82, 
       88, 96, 104, 112, 120, 128, 136, 144, 152, 158, 164, 170, 174, 177, 
       181, 184, 188, 191}, {{26}, {27}, {1}, {12}, {34}, {45}, {26}, {34}, {
       45}, {22}, {28}, {56}, {67}, {27}, {56}, {67}, {1}, {12}, {78}, {89}, {
       95}, {97}, {29}, {30}, {35}, {78}, {95}, {96}, {31}, {32}, {35}, {
       89}, {96}, {97}, {22}, {28}, {36}, {37}, {38}, {40}, {29}, {30}, {
       36}, {38}, {39}, {41}, {2}, {33}, {37}, {39}, {40}, {41}, {31}, {32}, {
       42}, {43}, {44}, {47}, {3}, {4}, {42}, {44}, {46}, {48}, {5}, {6}, {
       43}, {46}, {47}, {48}, {2}, {33}, {49}, {50}, {51}, {53}, {3}, {4}, {
       49}, {51}, {52}, {54}, {7}, {8}, {50}, {52}, {53}, {54}, {5}, {6}, {
       55}, {57}, {58}, {59}, {62}, {65}, {9}, {10}, {55}, {59}, {60}, {61}, {
       63}, {66}, {11}, {13}, {57}, {60}, {62}, {63}, {64}, {68}, {14}, {
       15}, {58}, {61}, {64}, {65}, {66}, {68}, {7}, {8}, {69}, {70}, {71}, {
       72}, {75}, {79}, {9}, {10}, {69}, {72}, {73}, {74}, {76}, {80}, {16}, {
       17}, {70}, {73}, {75}, {76}, {77}, {81}, {18}, {19}, {71}, {74}, {
       77}, {79}, {80}, {81}, {11}, {13}, {82}, {83}, {84}, {86}, {16}, {
       17}, {82}, {84}, {85}, {87}, {20}, {21}, {83}, {85}, {86}, {87}, {
       14}, {15}, {88}, {90}, {23}, {88}, {90}, {18}, {19}, {91}, {92}, {
       24}, {91}, {92}, {20}, {21}, {93}, {94}, {25}, {93}, {
       94}}}, CompressedData["
1:eJxTTMoPymNkYGDYD8SMSPg/FKCL4ZMjJE+MWkJyuNRhcwsx7iHFDmLV4pLD
ZxYudxETjrjsRVdDqdnUtp8a4YgrLkmVAwBrNX1m
      "]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"Function", "[", 
    RowBox[{"currents$", ",", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KeyMap", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"jvars$50670", ",", "jtvars$50670"}], "]"}], "]"}], "[", 
           "CostArgs$50670", "]"}], "/@", "vars$50670"}], ",", "currents$"}], 
        "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "j1", ",", "j10", ",", "j11", ",", "j12", ",", "j13", ",", "j14", ",", 
     "j15", ",", "j16", ",", "j17", ",", "j18", ",", "j19", ",", "j2", ",", 
     "j20", ",", "j21", ",", "j22", ",", "j23", ",", "j24", ",", "j25", ",", 
     "j26", ",", "j27", ",", "j28", ",", "j3", ",", "j30", ",", "j32", ",", 
     "j34", ",", "j36", ",", "j38", ",", "j4", ",", "j5", ",", "j6", ",", 
     "j7", ",", "j8", ",", "j9", ",", "jt1", ",", "jt10", ",", "jt11", ",", 
     "jt12", ",", "jt13", ",", "jt14", ",", "jt15", ",", "jt16", ",", "jt17", 
     ",", "jt18", ",", "jt19", ",", "jt2", ",", "jt20", ",", "jt21", ",", 
     "jt22", ",", "jt23", ",", "jt24", ",", "jt25", ",", "jt26", ",", "jt27", 
     ",", "jt28", ",", "jt29", ",", "jt3", ",", "jt30", ",", "jt31", ",", 
     "jt32", ",", "jt33", ",", "jt34", ",", "jt35", ",", "jt36", ",", "jt37", 
     ",", "jt38", ",", "jt39", ",", "jt4", ",", "jt40", ",", "jt41", ",", 
     "jt42", ",", "jt43", ",", "jt44", ",", "jt45", ",", "jt46", ",", "jt47", 
     ",", "jt48", ",", "jt49", ",", "jt5", ",", "jt50", ",", "jt51", ",", 
     "jt52", ",", "jt53", ",", "jt54", ",", "jt55", ",", "jt56", ",", "jt57", 
     ",", "jt58", ",", "jt59", ",", "jt6", ",", "jt60", ",", "jt61", ",", 
     "jt62", ",", "jt63", ",", "jt64", ",", "jt7", ",", "jt8", ",", "jt9"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.859427397479912*^9, 3.859429200251218*^9, 
  3.859884130234515*^9, 3.8598842334637814`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"f9bcd7d0-0515-44c1-b67b-37c258241c91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-linear case ", "Subsubsection",
 CellChangeTimes->{{3.806651547979834*^9, 
  3.8066515626656303`*^9}},ExpressionUUID->"88ea3444-42f9-4668-86df-\
23853acb21f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FFR", "=", 
  RowBox[{
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{"FixedReduceX1", "[", "MFGEquations", "]"}], ",", 
     RowBox[{
      RowBox[{"MFGEquations", "[", "\"\<criticalreduced1\>\"", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "10", ",", 
     RowBox[{"SameTest", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MFGEquations", "[", "\"\<Nlhs\>\"", "]"}], "-", 
            RowBox[{"MFGEquations", "[", "\"\<Nrhs\>\"", "]"}]}], "/.", "#"}],
           "]"}], "<", 
         RowBox[{"MFGEquations", "[", "\"\<TOL\>\"", "]"}]}], "&"}], 
       ")"}]}]}], "]"}], "//", "KeySort"}]}]}], "Input",
 CellChangeTimes->{{3.808126142141547*^9, 3.8081261460059547`*^9}, {
   3.810539024323907*^9, 3.810539034152894*^9}, {3.812184669640719*^9, 
   3.812184677454872*^9}, {3.812625386393382*^9, 3.812625433369575*^9}, {
   3.812625811885701*^9, 3.812625812292194*^9}, {3.812626877712508*^9, 
   3.81262687792752*^9}, {3.812626922255061*^9, 3.8126269235282087`*^9}, {
   3.812627134162677*^9, 3.8126271357051983`*^9}, {3.8126272423039293`*^9, 
   3.8126272424476023`*^9}, 3.812633637074614*^9, 3.81263380853738*^9, {
   3.812689391837798*^9, 3.812689394949883*^9}, {3.812772900393942*^9, 
   3.812772901335569*^9}, {3.812773061346002*^9, 3.812773061910006*^9}, {
   3.812773179599184*^9, 3.81277318060874*^9}, {3.8127757940870857`*^9, 
   3.81277579422501*^9}, {3.812775953363473*^9, 3.812775953465438*^9}, {
   3.812776014690617*^9, 3.8127760148371983`*^9}, {3.81277901550498*^9, 
   3.812779016391673*^9}, {3.812786671108713*^9, 3.8127867103289013`*^9}, {
   3.812786768469487*^9, 3.81278676872291*^9}, {3.812962156143097*^9, 
   3.81296215632146*^9}, 
   3.8129622270513372`*^9},ExpressionUUID->"ee890b38-6abf-495d-8540-\
027d1ca1d52d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["kdkd", "Title",
 CellChangeTimes->{{3.859431316549872*^9, 
  3.859431316846743*^9}},ExpressionUUID->"aef29f4f-cea9-49fc-9f73-\
a2bed18da23f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Wolfram", " ", "Language", " ", "package"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"D2E", "::", "usage"}], "=", 
    "\"\<D2E[<|\\\"Vertices List\\\" -> {1, 2, 3}, \\\"Adjacency Matrix\\\" \
-> {{0, 0, 0}, {1, 0, 1}, {0, 0, 0}}, \n \\\"Entrance Vertices and Currents\\\
\" -> {{2, I1}}, \n \\\"Exit Vertices and Terminal Costs\\\" -> {{1, U1}, {3, \
U2}}, \n \\\"Switching Costs\\\" -> {{1, 2, 3, S1}, {3, 2, 1, S2}}|> returns \
the equations for the stationary mean-field game on the network.]\>\""}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{"D2E", "[", "Data_Association", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "BG", ",", "FG", ",", "AuxiliaryGraph", ",", "VL", ",", "FVL", ",", 
        "EntranceVertices", ",", "InwardVertices", ",", "ExitVertices", ",", 
        "OutwardVertices", ",", "EL", ",", "BEL", ",", "OutEdges", ",", 
        "InEdges", ",", "ExitNeighbors", ",", "AllTransitions", ",", "EqCcs", 
        ",", 
        RowBox[{"SC", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"Data", ",", "\"\<Switching Costs\>\"", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ",", "jargs", ",", "js", ",", 
        "jvars", ",", "jts", ",", "jtvars", ",", "uargs", ",", "us", ",", 
        "uvars", ",", "SignedCurrents", ",", "EntryArgs", ",", "NoDeadEnds", 
        ",", "NoDeadStarts", ",", "ExitCosts", ",", "EntryDataAssociation", 
        ",", "SwitchingCosts", ",", "EqPosCon", ",", "EqCurrentCompCon", ",", 
        "EqTransitionCompCon", ",", "EqSwitchingByVertex", ",", 
        "EqSwitchingConditions", ",", "EqCompCon", ",", 
        "EqValueAuxiliaryEdges", ",", "EqBalanceSplittingCurrents", ",", 
        "EqBalanceGatheringCurrents", ",", "Nrhs", ",", "Nlhs", ",", 
        "MinimalTimeRhs", ",", "AllOr", ",", "EqAllAll", ",", "AllIneq", ",", 
        "EqCriticalCase", ",", "EqMinimalTime", ",", "EqNonCritical", ",", 
        "EqPosJs", ",", "TrueEq", ",", "costpluscurrents", ",", 
        "RuleBalanceGatheringCurrents", ",", "RuleEntryIn", ",", 
        "RuleEntryOut", ",", "RuleExitValues", ",", "RuleExitCurrentsIn", ",",
         "InitRules", ",", "OutRules", ",", "InRules", ",", "RuleNonCritical",
         ",", "RuleNonCritical1", ",", "RulesCriticalCase", ",", 
        "RulesCriticalCase1", ",", 
        RowBox[{"(*", 
         RowBox[{",", "EqNonCritical1"}], "*)"}], "EqPosJts", ",", 
        "BalanceSplittingCurrents", ",", "BalanceGatheringCurrents", ",", 
        "EqEntryIn", ",", "Kirchhoff", ",", "RuleValueAuxiliaryEdges", ",", 
        "BM", ",", "KM", ",", "vars"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Checking", " ", "consistency", " ", "on", " ", "the", " ", "swithing",
         " ", "costs"}], "*)"}], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SC", "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ConsistentSwithingCosts", "[", "sc_", "]"}], "[", 
            RowBox[{"{", 
             RowBox[{"a_", ",", "b_", ",", "c_", ",", "S_"}], "}"}], "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"or", ",", "de", ",", "bounds"}], "}"}], ",", 
             RowBox[{
              RowBox[{"or", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{"sc", ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "_", ",", "_"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"de", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{"sc", ",", 
                 RowBox[{"{", 
                  RowBox[{"_", ",", "b", ",", "c", ",", "_"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"bounds", "=", 
               RowBox[{
                RowBox[{"Outer", "[", 
                 RowBox[{"Plus", ",", 
                  RowBox[{"Last", "/@", "or"}], ",", 
                  RowBox[{"Last", "/@", "de"}]}], "]"}], "//", "Flatten"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"And", "@@", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"NonNegative", "[", 
                    RowBox[{"#", "-", "S"}], "]"}], "&"}], ")"}], "/@", 
                 "bounds"}]}], "*)"}], 
              RowBox[{"And", "@@", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#", ">=", "S"}], "&"}], ")"}], "/@", 
                "bounds"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"EqCcs", "=", 
           RowBox[{
            RowBox[{"ConsistentSwithingCosts", "[", "SC", "]"}], "/@", 
            "SC"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"EqCcs", "=", 
           RowBox[{"Simplify", "[", "EqCcs", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{"EqCcs", ",", 
              RowBox[{
               RowBox[{"#", "===", "False"}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<DataToEquations: Triangle inequalities for switching \
costs: \\n\>\"", ",", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"SC", ",", "EqCcs"}], "]"}], ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"exp", ",", 
                   RowBox[{"!", 
                    RowBox[{"TrueQ", "[", "exp", "]"}]}]}], "]"}]}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<DataToEquations: The switching costs are \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<incompatible\>\"", ",", "Red"}], "]"}], ",", 
               "\"\<. \\nStopping!\>\""}], "]"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"**", 
         RowBox[{"*", "Graph", " ", "stuff"}]}], "****)"}], 
       RowBox[{"BG", "=", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"Data", "[", "\"\<Vertices List\>\"", "]"}], ",", 
          RowBox[{"Data", "[", "\"\<Adjacency Matrix\>\"", "]"}], ",", 
          RowBox[{"VertexLabels", "->", "\"\<Name\>\""}], ",", 
          RowBox[{"DirectedEdges", "->", "True"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EntranceVertices", "=", 
        RowBox[{"First", "/@", 
         RowBox[{
         "Data", "[", "\"\<Entrance Vertices and Currents\>\"", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ExitVertices", "=", 
        RowBox[{"First", "/@", 
         RowBox[{
         "Data", "[", "\"\<Exit Vertices and Terminal Costs\>\"", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "\"\<en*\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "InwardVertices", " ", "defines", " ", "auxiliary", " ", "vertices", 
         " ", "for", " ", "the", " ", "entrance", " ", "vertices"}], "*)"}], 
       RowBox[{"InwardVertices", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"EntranceVertices", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<en\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           "EntranceVertices"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "\"\<ex*\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"OutwardVertices", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"ExitVertices", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<ex\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           "ExitVertices"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "InEdges", " ", "defines", " ", "auxiliary", " ", "arguments", " ", 
         "for", " ", "the", " ", "entrance", " ", "vertices"}], "*)"}], 
       RowBox[{"InEdges", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"DirectedEdge", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InwardVertices", "/@", "EntranceVertices"}], ",", 
            "EntranceVertices"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"OutEdges", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"DirectedEdge", ",", 
          RowBox[{"{", 
           RowBox[{"ExitVertices", ",", 
            RowBox[{"OutwardVertices", "/@", "ExitVertices"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AuxiliaryGraph", "=", 
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"InEdges", ",", "OutEdges"}], "]"}], ",", 
          RowBox[{"VertexLabels", "->", "\"\<Name\>\""}], ",", 
          RowBox[{"GraphLayout", "->", "\"\<SpringEmbedding\>\""}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"FG", "=", 
        RowBox[{"EdgeAdd", "[", 
         RowBox[{"BG", ",", 
          RowBox[{"Join", "[", 
           RowBox[{"InEdges", ",", "OutEdges"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"VL", "=", 
        RowBox[{"Data", "[", "\"\<Vertices List\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EL", "=", 
        RowBox[{"EdgeList", "[", "FG", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BEL", "=", 
        RowBox[{"EdgeList", "[", "BG", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FVL", "=", 
        RowBox[{"VertexList", "[", "FG", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", "arguments", "*)"}], 
       RowBox[{"jargs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AtTail", "@", "#"}], ",", 
              RowBox[{"AtHead", "@", "#"}]}], "}"}], "&"}], "/@", "EL"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"uargs", "=", "jargs"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllTransitions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TransitionsAt", "[", 
            RowBox[{"FG", ",", "#"}], "]"}], "&"}], "/@", "FVL"}], "//", 
         "Catenate"}]}], 
       RowBox[{"(*", 
        RowBox[{
        "at", " ", "vertex", " ", "from", " ", "first", " ", "edge", " ", 
         "to", " ", "second", " ", "edge"}], "*)"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EntryArgs", "=", 
        RowBox[{"AtHead", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"AuxiliaryGraph", ",", 
                RowBox[{"_", "\[DirectedEdge]", "#"}]}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"First", "/@", 
               RowBox[{
               "Data", "[", "\"\<Entrance Vertices and Currents\>\"", "]"}]}],
               ")"}]}], ")"}], "//", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EntryDataAssociation", "=", 
        RowBox[{"RoundValues", "@", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"EntryArgs", ",", 
           RowBox[{"Last", "/@", 
            RowBox[{
            "Data", "[", "\"\<Entrance Vertices and Currents\>\"", "]"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ExitCosts", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"OutwardVertices", "/@", 
           RowBox[{"(", 
            RowBox[{"First", "/@", 
             RowBox[{
             "Data", "[", "\"\<Exit Vertices and Terminal Costs\>\"", "]"}]}],
             ")"}]}], ",", 
          RowBox[{"Last", "/@", 
           RowBox[{
           "Data", "[", "\"\<Exit Vertices and Terminal Costs\>\"", "]"}]}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "variables", "*)"}], 
       RowBox[{"js", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<j\>\"", "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "jargs"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"jvars", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"jargs", ",", "js"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<jt\>\"", "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "AllTransitions"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"jtvars", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"AllTransitions", ",", "jts"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"us", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<u\>\"", "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "uargs"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"uvars", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"uargs", ",", "us"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"costpluscurrents", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<cpc\>\"", "<>", 
            RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "BEL"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"costpluscurrentsvars", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"BEL", ",", "costpluscurrents"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{"SignedCurrents", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"BEL", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"jvars", "[", 
               RowBox[{"AtHead", "[", "#", "]"}], "]"}], "-", 
              RowBox[{"jvars", "[", 
               RowBox[{"AtTail", "[", "#", "]"}], "]"}]}], "&"}], ")"}], "/@",
            "BEL"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<D2E: Variables are all set\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Elements", " ", "of", " ", "the", " ", "system"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Swithing", " ", "cost", " ", "is", " ", "initialized", " ", "with", 
         " ", "0.", " ", "AssociationThread", " ", "associates", " ", "the", 
         " ", "last", " ", 
         RowBox[{"association", "!"}]}], "*)"}], 
       RowBox[{"SwitchingCosts", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"AllTransitions", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"triple2path", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"#", ",", "3"}], "]"}], ",", "FG"}], "]"}], "&"}], "/@",
              "SC"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"0", "&"}], "/@", "AllTransitions"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "&"}], "/@", "SC"}]}], "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SC", "=", 
        RowBox[{"path2triple", "/@", 
         RowBox[{"Normal", "[", "SwitchingCosts", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SC", "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Second check:\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"ConsistentSwithingCosts", "[", 
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_", ",", "c_", ",", "S_"}], "}"}], "]"}], 
             ":=", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"sc", "=", "SC"}], ",", "or", ",", "de", ",", 
                 "bounds"}], "}"}], ",", 
               RowBox[{
                RowBox[{"or", "=", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"sc", ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "_", ",", "_"}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"de", "=", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"sc", ",", 
                   RowBox[{"{", 
                    RowBox[{"_", ",", "b", ",", "c", ",", "_"}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"bounds", "=", 
                 RowBox[{
                  RowBox[{"Outer", "[", 
                   RowBox[{"Plus", ",", 
                    RowBox[{"Last", "/@", "or"}], ",", 
                    RowBox[{"Last", "/@", "de"}]}], "]"}], "//", 
                  "Flatten"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"And", "@@", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NonNegative", "[", 
                    RowBox[{"#", "-", "S"}], "]"}], "&"}], ")"}], "/@", 
                   "bounds"}]}], "*)"}], 
                RowBox[{"And", "@@", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", ">=", "S"}], "&"}], ")"}], "/@", 
                  "bounds"}]}]}]}], "]"}]}], ";"}], "*)"}], 
          RowBox[{"EqCcs", "=", 
           RowBox[{
            RowBox[{"ConsistentSwithingCosts", "[", "SC", "]"}], "/@", 
            "SC"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"EqCcs", "=", 
           RowBox[{"Simplify", "[", "EqCcs", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "EqCcs", "]"}], ";"}], "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{"EqCcs", ",", 
              RowBox[{
               RowBox[{"#", "===", "False"}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<DataToEquations: Triangle inequalities for switching \
costs: \>\"", ",", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{"SC", ",", "EqCcs"}], "]"}], ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"exp", ",", 
                   RowBox[{"!", 
                    RowBox[{"TrueQ", "[", "exp", "]"}]}]}], "]"}]}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<DataToEquations: The switching costs are \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<incompatible\>\"", ",", "Red"}], "]"}], ",", 
               "\"\<. \\nStopping!\>\""}], "]"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"Return", "[", "]"}]}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EqPosJs", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", ">=", "0"}], "&"}], "/@", 
           RowBox[{"Join", "[", "jvars", "]"}]}], ")"}]}]}], ";", 
       RowBox[{"(*", "Inequality", "*)"}], 
       RowBox[{"EqPosJts", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", ">=", "0"}], "&"}], "/@", 
           RowBox[{"Join", "[", "jtvars", "]"}]}], ")"}]}]}], ";", 
       RowBox[{"(*", "Inequality", "*)"}], 
       RowBox[{"EqPosCon", "=", 
        RowBox[{"EqPosJs", "&&", "EqPosJts"}]}], ";", 
       RowBox[{"(*", "Inequality", "*)"}], 
       RowBox[{"EqCurrentCompCon", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"CurrentCompCon", "[", "jvars", "]"}], "/@", "EL"}], 
          ")"}]}]}], ";", 
       RowBox[{"(*", "Or", "*)"}], 
       RowBox[{"EqTransitionCompCon", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Sort", "/@", 
             RowBox[{
              RowBox[{"TransitionCompCon", "[", "jtvars", "]"}], "/@", 
              "AllTransitions"}]}], ")"}], "//", "Union"}], ")"}]}]}], ";", 
       RowBox[{"(*", "Or", "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Balance", " ", "Splitting", " ", "Currents", " ", "in", " ", "the", 
         " ", "full", " ", "graph"}], "*)"}], 
       RowBox[{"NoDeadEnds", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"IncomingEdges", "[", "FG", "]"}], "/@", "VL"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EqBalanceSplittingCurrents", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"jvars", "[", "#", "]"}], "==", 
              RowBox[{"Total", "[", 
               RowBox[{"jtvars", "/@", 
                RowBox[{
                 RowBox[{"CurrentSplitting", "[", "AllTransitions", "]"}], 
                 "[", "#", "]"}]}], "]"}]}], ")"}], "&"}], "/@", 
           "NoDeadEnds"}], ")"}]}]}], ";", 
       RowBox[{"(*", "Equal", "*)"}], 
       RowBox[{"BalanceSplittingCurrents", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"jvars", "[", "#", "]"}], "-", 
             RowBox[{"Total", "[", 
              RowBox[{"jtvars", "/@", 
               RowBox[{
                RowBox[{"CurrentSplitting", "[", "AllTransitions", "]"}], "[",
                 "#", "]"}]}], "]"}]}], ")"}], "&"}], "/@", "NoDeadEnds"}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Gathering", " ", "currents", " ", "in", " ", "the", " ", "inside", 
         " ", "of", " ", "the", " ", "basic", " ", "graph"}], "*)"}], 
       RowBox[{"NoDeadStarts", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"OutgoingEdges", "[", "FG", "]"}], "/@", "VL"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RuleBalanceGatheringCurrents", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"jvars", "[", "#", "]"}], "->", 
            RowBox[{"Total", "[", 
             RowBox[{"jtvars", "/@", 
              RowBox[{
               RowBox[{"CurrentGathering", "[", "AllTransitions", "]"}], "[", 
               "#", "]"}]}], "]"}]}], ")"}], "&"}], "/@", "NoDeadStarts"}]}], 
       ";", 
       RowBox[{"(*", "Rule", "*)"}], 
       RowBox[{"(*", 
        RowBox[{"First", " ", 
         RowBox[{"rules", ":", 
          RowBox[{
          "these", " ", "have", " ", "some", " ", "j", " ", "in", " ", 
           "terms", " ", "of", " ", "jts"}]}]}], "*)"}], 
       RowBox[{"InitRules", "=", 
        RowBox[{"Association", "[", "RuleBalanceGatheringCurrents", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "get", " ", "equations", " ", "for", " ", "the", " ", "exit", " ", 
         "currents", " ", "at", " ", "the", " ", "entry", " ", "vertices"}], 
        "*)"}], 
       RowBox[{"BalanceGatheringCurrents", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"jvars", "[", "#", "]"}]}], "+", 
             RowBox[{"Total", "[", 
              RowBox[{"jtvars", "/@", 
               RowBox[{
                RowBox[{"CurrentGathering", "[", "AllTransitions", "]"}], "[",
                 "#", "]"}]}], "]"}]}], ")"}], "&"}], "/@", "NoDeadStarts"}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EqBalanceGatheringCurrents", "=", 
        RowBox[{"Simplify", "/@", 
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "==", "0"}], "&"}], "/@", 
             "BalanceGatheringCurrents"}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Incoming", " ", "currents"}], "*)"}], 
       RowBox[{"EqEntryIn", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"jvars", "[", "#", "]"}], "==", 
            RowBox[{"EntryDataAssociation", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"AtHead", "/@", "InEdges"}], ")"}]}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"List", " ", "of", " ", "Equals"}], "*)"}], 
       RowBox[{"RuleEntryIn", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ToRules", "/@", "EqEntryIn"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"List", " ", "of", " ", "Rules"}], "*)"}], 
       RowBox[{"Kirchhoff", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"EqEntryIn", ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "==", "0"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
             "BalanceGatheringCurrents", "+", "BalanceSplittingCurrents"}], 
             ")"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<The matrices B and K are: \\n\>\"", ",", 
           RowBox[{"MatrixForm", "/@", 
            RowBox[{"CoefficientArrays", "[", 
             RowBox[{"Kirchhoff", ",", 
              RowBox[{"vars", "=", 
               RowBox[{"RandomSample", "@", 
                RowBox[{"Join", "[", 
                 RowBox[{"js", ",", "jts"}], "]"}]}]}]}], "]"}]}], ",", 
           "\"\<\\nThe order of the variables is \\n\>\"", ",", "vars"}], 
          "]"}], ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"Outgoing", " ", "currents", " ", "at", " ", "entrances"}], 
        "*)"}], 
       RowBox[{"RuleEntryOut", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"jvars", "[", "#", "]"}], "->", "0"}], ")"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"AtTail", "/@", "InEdges"}], ")"}]}]}], ";", 
       RowBox[{"(*", "Rule", "*)"}], 
       RowBox[{"RuleEntryIn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"RuleEntryIn", ",", "RuleEntryOut"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Not", " ", "necessary", " ", "to", " ", "replace", " ", 
         "RuleEntryIn", " ", "in", " ", "InitRules"}], "*)"}], 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"InitRules", ",", "RuleEntryIn"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Include", " ", "Gathering", " ", "currents", " ", "information", " ",
          "in", " ", "the", " ", "rules"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueEq", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "EqBalanceGatheringCurrents", "/.", " ", 
            "RuleBalanceGatheringCurrents"}], ",", "InitRules"}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ExitNeighbors", "=", 
        RowBox[{"IncidenceList", "[", 
         RowBox[{"AuxiliaryGraph", ",", 
          RowBox[{"OutwardVertices", "/@", "ExitVertices"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "ExitNeighbors", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "OutEdges", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "TODO", " ", "this", " ", "seems", " ", "to", " ", "be", " ", 
         "defined", " ", 
         RowBox[{"already", ":", "OutEdges"}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Incoming", " ", "currents", " ", "at", " ", "the", " ", "exits", " ",
          "are", " ", "zero"}], "*)"}], 
       RowBox[{"RuleExitCurrentsIn", "=", 
        RowBox[{
         RowBox[{"ExitCurrents", "[", "jvars", "]"}], "/@", 
         "ExitNeighbors"}]}], ";", 
       RowBox[{"(*", "Rule", "*)"}], 
       RowBox[{"Kirchhoff", "=", 
        RowBox[{"Kirchhoff", "/.", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"RuleExitCurrentsIn", ",", "RuleEntryOut"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"BM", ",", "KM"}], "}"}], "=", 
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{"Kirchhoff", ",", 
          RowBox[{"vars", "=", 
           RowBox[{"Variables", "[", 
            RowBox[{"Kirchhoff", "/.", " ", 
             RowBox[{"Equal", "->", "Plus"}]}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The matrices B and K are: \\n\>\"", ",", 
         RowBox[{"MatrixForm", "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "BM"}], ",", "KM"}], "}"}]}], ",", 
         "\"\<\\nThe order of the variables is \\n\>\"", ",", "vars"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"InitRules", ",", "RuleExitCurrentsIn"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Exit", " ", "values", " ", "at", " ", "exit", " ", "vertices"}], 
        "*)"}], 
       RowBox[{"RuleExitValues", "=", 
        RowBox[{
         RowBox[{"ExitRules", "[", 
          RowBox[{"uvars", ",", "ExitCosts"}], "]"}], "/@", 
         "ExitNeighbors"}]}], ";", 
       RowBox[{"(*", "Rule", "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Not", " ", "necessary", " ", "to", " ", "replace", " ", 
          "RuleExitValues", " ", "in", " ", "InitRules"}], ",", 
         RowBox[{
         "there", " ", "are", " ", "no", " ", "us", " ", "up", " ", "to", " ", 
          RowBox[{"now", "."}]}]}], "*)"}], 
       RowBox[{"Print", "[", "RuleExitValues", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"InitRules", ",", "RuleExitValues"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "value", " ", "function", " ", "on", " ", "the", " ", 
         "auxiliary", " ", "edges", " ", "is", " ", "constant", " ", "and", 
         " ", "equal", " ", "to", " ", "the", " ", "exit", " ", 
         RowBox[{"cost", "."}]}], "*)"}], 
       RowBox[{"EqValueAuxiliaryEdges", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"uvars", "[", 
               RowBox[{"AtHead", "[", "#", "]"}], "]"}], "==", 
              RowBox[{"uvars", "[", 
               RowBox[{"AtTail", "[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{"InEdges", ",", "OutEdges"}], "]"}]}], ")"}]}]}], ";", 
       RowBox[{"(*", "Equal", "*)"}], 
       RowBox[{"RuleValueAuxiliaryEdges", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"uvars", "[", 
             RowBox[{"AtTail", "[", "#", "]"}], "]"}], "->", 
            RowBox[{"uvars", "[", 
             RowBox[{"AtHead", "[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Join", "[", 
          RowBox[{"InEdges", ",", "OutEdges"}], "]"}]}]}], ";", 
       RowBox[{"(*", "Equal", "*)"}], 
       RowBox[{
       "Print", "[", 
        "\"\<D2E: CleanEqualities for the values at the auxiliary edges\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueEq", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"EqValueAuxiliaryEdges", ",", "InitRules"}], "}"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "RuleValueAuxiliaryEdges", "]"}], ";"}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Infinite", " ", "switching", " ", "costs", " ", "here", " ", 
         "prevent", " ", "the", " ", "network", " ", "from", " ", "sucking", 
         " ", "agents", " ", "from", " ", "the", " ", 
         RowBox[{"exits", "."}]}], "*)"}], 
       RowBox[{"OutRules", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "Infinity"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AtTail", "[", "#1", "]"}], ",", "#2"}], "}"}], 
               "]"}], "&"}], ",", "OutEdges", ",", "EL"}], "]"}], "//", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InRules", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", "Infinity"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "#1", ",", "#2"}], 
               "}"}], "&"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"IncidenceList", "[", 
                RowBox[{"FG", ",", "#"}], "]"}], "&"}], "/@", 
              "EntranceVertices"}], ",", "InEdges"}], "]"}], "//", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"SwitchingCosts", ",", 
         RowBox[{"Association", "[", "OutRules", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"SwitchingCosts", ",", 
         RowBox[{"Association", "[", "InRules", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<D2E: Assembled most elements of the system\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Switching", " ", "condition", " ", "equations"}], "*)"}], 
       RowBox[{"EqSwitchingByVertex", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transu", "[", 
            RowBox[{"uvars", ",", "SwitchingCosts"}], "]"}], "/@", 
           RowBox[{"TransitionsAt", "[", 
            RowBox[{"FG", ",", "#"}], "]"}]}], "&"}], "/@", "VL"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"EqSwitchingByVertex", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"BooleanConvert", "[", 
             RowBox[{
              RowBox[{"Reduce", "[", 
               RowBox[{
                RowBox[{"Reduce", "@", "#"}], ",", "Reals"}], "]"}], ",", 
              "\"\<CNF\>\""}], "]"}], "&"}], "/@", "EqSwitchingByVertex"}]}], 
         ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Maybe", " ", "this", " ", "is", " ", "good", " ", "with", " ", 
         "nonzeroswitching", " ", 
         RowBox[{"costs", "."}]}], "*)"}], 
       RowBox[{"EqSwitchingByVertex", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"BooleanConvert", "[", 
           RowBox[{
            RowBox[{"Reduce", "[", 
             RowBox[{"#", ",", "Reals"}], "]"}], ",", "\"\<CNF\>\""}], "]"}], 
          "&"}], "/@", "EqSwitchingByVertex"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"EqSwitchingByVertex", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"EqSwitchingByVertex", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<D2E: CleanEqualities for the switching conditions on each \
vertex: \\n\>\"", ",", 
         RowBox[{"Reduce", "@", "EqSwitchingByVertex"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"EqSwitchingConditions", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"EqSwitchingByVertex", ",", "InitRules"}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"EqCompCon", "=", 
        RowBox[{"And", "@@", 
         RowBox[{
          RowBox[{"Compu", "[", 
           RowBox[{"jtvars", ",", "uvars", ",", "SwitchingCosts"}], "]"}], "/@",
           "AllTransitions"}]}]}], ";", 
       RowBox[{"(*", "Or", "*)"}], 
       RowBox[{
       "Print", "[", 
        "\"\<D2E: CleanEqualities for the complementary conditions (given the \
rules)\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"EqCompCon", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"EqCompCon", ",", "InitRules"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Default", " ", "in", " ", "a"}], ",", "function", ",", 
         RowBox[{
         "corresponds", " ", "to", " ", "the", " ", "classic", " ", 
          "critical", " ", "congestion", " ", "case"}]}], "*)"}], 
       RowBox[{"a", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            RowBox[{"SignedCurrents", "[", "edge", "]"}], ",", "edge"}], 
           "]"}], ":"}], "*)"}], "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{"Data", ",", "\"\<a\>\"", ",", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", "edge"}], "}"}], ",", "j"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"MinimalTimeRhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"a", "[", 
              RowBox[{
               RowBox[{"SignedCurrents", "[", "#", "]"}], ",", "#"}], "]"}]}],
             "+", 
            RowBox[{"SignedCurrents", "[", "#", "]"}]}], "&"}], "/@", "BEL"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Nlhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"uvars", "[", 
             RowBox[{"AtHead", "[", "#", "]"}], "]"}], "-", 
            RowBox[{"uvars", "[", 
             RowBox[{"AtTail", "[", "#", "]"}], "]"}], "+", 
            RowBox[{"SignedCurrents", "[", "#", "]"}]}], "&"}], "/@", "BEL"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EqMinimalTime", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "==", "#2"}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"Nlhs", ",", "MinimalTimeRhs"}], "}"}]}], "]"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Nrhs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cost", "[", 
              RowBox[{
               RowBox[{"SignedCurrents", "[", "#", "]"}], ",", "#"}], "]"}]}],
             "+", 
            RowBox[{"SignedCurrents", "[", "#", "]"}]}], "&"}], "/@", "BEL"}],
          "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"one", " ", "possible", " ", "cost", " ", "is", " ", "IntM"}],
         "*)"}], 
       RowBox[{
       "Print", "[", 
        "\"\<D2E: CleanEqualities for the balance conditions in terms of \
(mostly) transition currents\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueEq", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"EqBalanceSplittingCurrents", ",", "InitRules"}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllOr", "=", 
        RowBox[{
        "EqCurrentCompCon", "&&", "EqTransitionCompCon", "&&", 
         "EqCompCon"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllOr", "=", 
        RowBox[{"AllOr", "/.", "InitRules"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllOr", "=", 
        RowBox[{"BooleanConvert", "[", 
         RowBox[{
          RowBox[{"Simplify", "/@", "AllOr"}], ",", "\"\<CNF\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"AllOr", ",", "InitRules"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"AllOr", ",", "InitRules"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EqPosCon", "=", 
        RowBox[{"EqPosCon", "/.", " ", "InitRules"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EqSwitchingConditions", "=", 
        RowBox[{"EqSwitchingConditions", "/.", "InitRules"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"EqSwitchingConditions", "=", 
        RowBox[{"Simplify", "[", "EqSwitchingConditions", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AllOr", "=", 
        RowBox[{"AllOr", "&&", 
         RowBox[{"Select", "[", 
          RowBox[{"EqSwitchingConditions", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "===", "Or"}], "&"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllOr", "=", 
        RowBox[{"BooleanConvert", "[", 
         RowBox[{"AllOr", ",", "\"\<CNF\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AllIneq", "=", 
        RowBox[{"EqPosCon", "&&", 
         RowBox[{"Select", "[", 
          RowBox[{"EqSwitchingConditions", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "=!=", "Or"}], "&"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AllIneq", "=", 
        RowBox[{"Simplify", "[", "AllIneq", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AllOr", "=", 
          RowBox[{"BooleanConvert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Simplify", "[", 
               RowBox[{"#", ",", "AllIneq"}], "]"}], "&"}], "/@", "AllOr"}], 
            ",", "\"\<CNF\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"EqAllAll", ",", "InitRules"}], "}"}], "=", 
          RowBox[{"CleanEqualities", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AllOr", "&&", "AllIneq"}], ",", "InitRules"}], "}"}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"EqCriticalCase", "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "==", "0"}], ")"}], "&"}], "/@", "Nlhs"}], 
          ")"}]}]}], ";", 
       RowBox[{"(*", "Equal", "*)"}], 
       RowBox[{"EqNonCritical", "=", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Equal", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"Nlhs", ",", 
               RowBox[{"costpluscurrents", "/.", "InitRules"}]}], "}"}]}], 
            "]"}], ")"}]}], "/.", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"us", ",", 
           RowBox[{"us", "/.", "InitRules"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RuleNonCritical1", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"EqNonCritical", ",", "Reals"}], "]"}], "//", "Quiet"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"The", " ", "operations", " ", "below", " ", "are", " ", 
          RowBox[{"commutative", "!"}], " ", 
          RowBox[{"Print", "[", 
           RowBox[{"RuleNonCritical1", "/.", " ", 
            RowBox[{"AssociationThread", "[", 
             RowBox[{"costpluscurrents", ",", 
              RowBox[{
               RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"EqNonCritical", "/.", " ", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{"costpluscurrents", ",", 
                RowBox[{
                 RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
             ",", "Reals"}], "]"}], "//", "Quiet"}], "]"}], ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"EqCriticalCase", "/.", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"us", ",", 
             RowBox[{"us", "/.", "InitRules"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"EqNonCritical", "/.", " ", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"costpluscurrents", ",", 
             RowBox[{
              RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<right?\\n\>\"", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"EqCriticalCase", "/.", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{"us", ",", 
                RowBox[{"us", "/.", "InitRules"}]}], "]"}]}], ")"}], "/.", 
            "RuleNonCritical1"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<right?\\n\>\"", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"EqCriticalCase", "/.", " ", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{"costpluscurrents", ",", 
                RowBox[{
                 RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
             ")"}], "/.", 
            RowBox[{"(", 
             RowBox[{"RuleNonCritical1", "/.", " ", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{"costpluscurrents", ",", 
                RowBox[{
                 RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
             ")"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"EqNonCritical", "/.", " ", "RuleNonCritical1"}], "]"}], 
         ";"}], "*)"}], 
       RowBox[{
       "Print", "[", 
        "\"\<D2E: CleanEqualities for the (non) critical case equations\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueEq", ",", "RuleNonCritical"}], "}"}], "=", 
        RowBox[{"CleanEqualities", "[", 
         RowBox[{"{", 
          RowBox[{"EqNonCritical", ",", "InitRules"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Expand", "/@", "RuleNonCritical"}], "]"}], ";"}], "*)"}], 
       RowBox[{"EqCriticalCase", "=", 
        RowBox[{"EqNonCritical", "/.", " ", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"costpluscurrents", ",", 
           RowBox[{
            RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "EqCriticalCase", "]"}], ";"}], "*)"}], 
       RowBox[{"RulesCriticalCase1", "=", 
        RowBox[{"Expand", "/@", 
         RowBox[{"(", 
          RowBox[{"RuleNonCritical1", "/.", " ", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"costpluscurrents", ",", 
             RowBox[{
              RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RulesCriticalCase", "=", 
        RowBox[{"Expand", "/@", 
         RowBox[{"(", 
          RowBox[{"RuleNonCritical", "/.", " ", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"costpluscurrents", ",", 
             RowBox[{
              RowBox[{"0", "&"}], "/@", "costpluscurrents"}]}], "]"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Here", " ", "we", " ", "change", " ", "the", " ", "pourpose", " ", 
         "of", " ", "costpluscurrents"}], "*)"}], 
       RowBox[{"costpluscurrents", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"costpluscurrents", ",", "Nrhs"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Solve", "[", 
           RowBox[{"EqCriticalCase", ",", "js"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"RulesCriticalCaseJs", "=", 
            RowBox[{"Association", "@", 
             RowBox[{"First", "[", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"EqCriticalCase", "/.", "RuleEntryIn"}], ",", "js"}], 
               "]"}], "]"}]}]}], ";"}], "*)"}], 
         RowBox[{
         "Print", "[", 
          "\"\<CleanEqualities for the critical case equations\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TrueEq", ",", "RulesCriticalCase"}], "}"}], "=", 
          RowBox[{"CleanEqualities", "[", 
           RowBox[{"{", 
            RowBox[{"EqCriticalCase", ",", "InitRules"}], "}"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<Expanding critical rules...\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"RulesCriticalCase", "=", 
          RowBox[{"Expand", "/@", "RulesCriticalCase"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "RulesCriticalCase", "]"}], ";"}], "*)"}], 
       RowBox[{"Print", "[", "\"\<D2E: D2E is finished!\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "$Context", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Names", "[", 
         RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ttt", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Names", "[", 
         RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"Data", ",", 
         RowBox[{"Association", "[", 
          RowBox[{"(*", 
           RowBox[{"Graph", " ", "structure"}], "*)"}], 
          RowBox[{
           RowBox[{"\"\<BG\>\"", "->", "BG"}], ",", 
           RowBox[{"\"\<InEdges\>\"", "->", "InEdges"}], ",", 
           RowBox[{"\"\<OutEdges\>\"", "->", "OutEdges"}], ",", 
           RowBox[{"\"\<FG\>\"", "->", "FG"}], ",", 
           RowBox[{"(*", "variables", "*)"}], 
           RowBox[{"\"\<jvars\>\"", "->", "jvars"}], ",", 
           RowBox[{"\"\<jtvars\>\"", "->", "jtvars"}], ",", 
           RowBox[{"\"\<uvars\>\"", "->", "uvars"}], ",", 
           RowBox[{"\"\<costpluscurrents\>\"", "->", "costpluscurrents"}], 
           ",", 
           RowBox[{"\"\<jays\>\"", "->", "SignedCurrents"}], ",", 
           RowBox[{"(*", "equations", "*)"}], 
           RowBox[{"(*", "complementarity", "*)"}], 
           RowBox[{"\"\<AllOr\>\"", "->", "AllOr"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "union", " ", "of", " ", "all", " ", "complementarity", " ", 
             "conditions"}], "*)"}], 
           RowBox[{"\"\<AllIneq\>\"", "->", "AllIneq"}], ",", 
           RowBox[{"\"\<EqPosJs\>\"", "->", "EqPosJs"}], ",", 
           RowBox[{"\"\<EqPosJts\>\"", "->", "EqPosJts"}], ",", 
           RowBox[{"\"\<EqPosCon\>\"", "->", "EqPosCon"}], ",", 
           RowBox[{"\"\<EqCurrentCompCon\>\"", "->", "EqCurrentCompCon"}], 
           ",", 
           RowBox[{
           "\"\<EqTransitionCompCon\>\"", "->", "EqTransitionCompCon"}], ",", 
           
           RowBox[{"(*", 
            RowBox[{"linear", " ", "equations", " ", 
             RowBox[{"(", 
              RowBox[{"and", " ", "inequalities"}], ")"}]}], "*)"}], 
           RowBox[{"\"\<EqAllAll\>\"", "->", "EqAllAll"}], ",", 
           RowBox[{"\"\<BoundaryRules\>\"", "->", "InitRules"}], ",", 
           RowBox[{"\"\<InitRules\>\"", "->", "InitRules"}], ",", 
           RowBox[{"\"\<RulesCriticalCase\>\"", "->", "RulesCriticalCase"}], 
           ",", 
           RowBox[{"\"\<RulesCriticalCase1\>\"", "->", "RulesCriticalCase1"}],
            ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "\"\<RulesCriticalCaseJs\>\"", "->", "RulesCriticalCaseJs"}], 
             ","}], "*)"}], 
           RowBox[{"\"\<RuleExitValues\>\"", "->", "RuleExitValues"}], ",", 
           RowBox[{"\"\<RuleEntryIn\>\"", "->", "RuleEntryIn"}], ",", 
           RowBox[{"\"\<Nlhs\>\"", "->", "Nlhs"}], ",", 
           RowBox[{"\"\<MinimalTimeRhs\>\"", "->", "MinimalTimeRhs"}], ",", 
           RowBox[{"\"\<EqCriticalCase\>\"", "->", "EqCriticalCase"}], ",", 
           RowBox[{"\"\<EqNonCritical\>\"", "->", "EqNonCritical"}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\"\<EqNonCritical1\>\"", "->", "EqNonCritical1"}], 
             ","}], "*)"}], 
           RowBox[{"\"\<RuleNonCritical\>\"", "->", "RuleNonCritical"}], ",", 
           
           RowBox[{"\"\<RuleNonCritical1\>\"", "->", "RuleNonCritical1"}], 
           ",", 
           RowBox[{"\"\<EqSwitchingConditions\>\"", "->", 
            RowBox[{"And", "@@", "EqSwitchingByVertex"}]}], ",", 
           RowBox[{
           "\"\<EqValueAuxiliaryEdges\>\"", "->", "EqValueAuxiliaryEdges"}], 
           ",", 
           RowBox[{
           "\"\<EqBalanceSplittingCurrents\>\"", "->", 
            "EqBalanceSplittingCurrents"}], ",", 
           RowBox[{
           "\"\<EqBalanceGatheringCurrents\>\"", "->", 
            "EqBalanceGatheringCurrents"}], ",", 
           RowBox[{"\"\<Nrhs\>\"", "->", "Nrhs"}], ",", 
           RowBox[{"\"\<B\>\"", "->", "BM"}], ",", 
           RowBox[{"\"\<K\>\"", "->", "KM"}], ",", 
           RowBox[{"\"\<NoDeadEnds\>\"", "->", "NoDeadEnds"}], ",", 
           RowBox[{"\"\<NoDeadStarts\>\"", "->", "NoDeadStarts"}], ",", 
           RowBox[{"\"\<EqEntryIn\>\"", "->", "EqEntryIn"}], ",", 
           RowBox[{"\"\<vars\>\"", "->", "vars"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<EntranceVertices\>\"", "->", "EntranceVertices"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<InwardVertices\>\"", "->", "InwardVertices"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<ExitVertices\>\"", "->", "ExitVertices"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<OutwardVertices\>\"", "->", "OutwardVertices"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<AuxiliaryGraph\>\"", "->", "AuxiliaryGraph"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<VL\>\"", "->", "VL"}], ",", 
     RowBox[{"\"\<EL\>\"", "->", "EL"}], ",", 
     RowBox[{"\"\<BEL\>\"", "->", "BEL"}], ",", 
     RowBox[{"\"\<FVL\>\"", "->", "FVL"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<AllTransitions\>\"", "->", "AllTransitions"}], ",", 
     RowBox[{"\"\<NoDeadEnds\>\"", "->", "NoDeadEnds"}], ",", 
     RowBox[{"\"\<NoDeadStarts\>\"", "->", "NoDeadStarts"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<jargs\>\"", "->", "jargs"}], ",", 
     RowBox[{"\"\<js\>\"", "->", "js"}], ","}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<jts\>\"", "->", "jts"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<uargs\>\"", "->", "uargs"}], ",", 
     RowBox[{"\"\<us\>\"", "->", "us"}], ","}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<SwitchingCosts\>\"", "->", "SwitchingCosts"}], ","}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<OutRules\>\"", "->", "OutRules"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<InRules\>\"", "->", "InRules"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<EntryArgs\>\"", "->", "EntryArgs"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<EntryDataAssociation\>\"", "->", "EntryDataAssociation"}], 
     ","}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<ExitCosts\>\"", "->", "ExitCosts"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<EqCompCon\>\"", "->", "EqCompCon"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\"\<EqPosCon\>\"", "->", "EqPosCon"}], ",", 
     RowBox[{"\"\<EqEntryIn\>\"", "->", "EqEntryIn"}], ",", 
     RowBox[{"\"\<EqExitValues\>\"", "->", "EqExitValues"}], ",", 
     RowBox[{"\"\<EqValueAuxiliaryEdges\>\"", "->", "EqValueAuxiliaryEdges"}],
      ",", 
     RowBox[{"\"\<AllIneq\>\"", "->", "AllIneq"}], ","}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   
   RowBox[{"End", "[", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.859431318802999*^9, 
  3.859431318804846*^9}},ExpressionUUID->"db0239ee-20b4-4a34-a0c4-\
18f53b779dc2"]
}, Open  ]]
},
WindowSize->{1680, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d10b8b05-029f-402c-806e-32cab955627c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 177, 3, 54, "Subsection",ExpressionUUID->"9d02279c-549c-4a7b-a0a3-3086c4faa000"],
Cell[CellGroupData[{
Cell[782, 29, 1664, 27, 94, "Input",ExpressionUUID->"4307edc5-c37f-40b8-b85e-e4011dc2650a"],
Cell[2449, 58, 393, 6, 34, "Output",ExpressionUUID->"2f041c83-545c-4989-a724-dce20da2a5b1"]
}, Open  ]],
Cell[2857, 67, 295, 8, 30, "Input",ExpressionUUID->"b93b4544-93d2-4ec7-b534-400f9879408d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3189, 80, 294, 4, 54, "Subsection",ExpressionUUID->"40572573-c3d2-4935-b25a-0520de835ab2"],
Cell[3486, 86, 1071, 16, 30, "Input",ExpressionUUID->"20f26292-94b2-455c-9005-babb32d5d746"],
Cell[4560, 104, 4838, 112, 178, "Input",ExpressionUUID->"2cd9451a-fe74-4087-8136-59cd2929bc8a"],
Cell[CellGroupData[{
Cell[9423, 220, 809, 19, 52, "Input",ExpressionUUID->"2ae874b2-72a4-43b5-9f6d-0f1242a9f6fa"],
Cell[10235, 241, 8050, 203, 285, "Output",ExpressionUUID->"5c154bfb-2697-402c-bcf0-2571fca0cb0a"],
Cell[18288, 446, 8052, 203, 285, "Output",ExpressionUUID->"094fd6dc-c61f-44da-a18d-7c75e0b1c197"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26377, 654, 256, 5, 30, "Input",ExpressionUUID->"8171d59b-513e-4b08-b013-b894b5b3f182"],
Cell[26636, 661, 2921, 65, 129, "Output",ExpressionUUID->"f67c667a-8835-4ff5-9187-ebfb16413e77"]
}, Open  ]],
Cell[29572, 729, 231, 5, 30, "Input",ExpressionUUID->"8bae9680-ae42-449a-8f31-4a7714294442"],
Cell[CellGroupData[{
Cell[29828, 738, 222, 3, 30, "Input",ExpressionUUID->"e737f0c2-9031-47ae-9aad-557d766de56e"],
Cell[30053, 743, 23536, 470, 158, "Output",ExpressionUUID->"f9bcd7d0-0515-44c1-b67b-37c258241c91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53626, 1218, 169, 3, 45, "Subsubsection",ExpressionUUID->"88ea3444-42f9-4668-86df-23853acb21f5"],
Cell[53798, 1223, 1983, 39, 52, "Input",ExpressionUUID->"ee890b38-6abf-495d-8540-027d1ca1d52d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55830, 1268, 147, 3, 98, "Title",ExpressionUUID->"aef29f4f-cea9-49fc-9f73-a2bed18da23f"],
Cell[55980, 1273, 60398, 1465, 3979, "Input",ExpressionUUID->"db0239ee-20b4-4a34-a0c4-18f53b779dc2"]
}, Open  ]]
}
]
*)

